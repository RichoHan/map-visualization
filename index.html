<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Map Visualization</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel='stylesheet' />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/6.0.13/css/bootstrap-slider.min.css" rel='stylesheet' />
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel='stylesheet' />
    <link href="static/index.css" rel='stylesheet' />
  </head>
  <body>

    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Map Visualization</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="#">Home</a></li>
            <li><a href="#about">About</a></li>
            <li><a href="#contact">Contact</a></li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="container">
      <div class="row">
        <div class="col-md-8">
          <div id="worldmap"></div>
          <input id="slider" type="text" data-slider-min="2009" data-slider-max="2014" data-slider-step="1" data-slider-value="2009"/>
        </div>
        <div class="col-md-4">
          <div id="twitter">
            <a class="twitter-timeline"  href="https://twitter.com/NCTUMapVis" data-widget-id="702892313056378881">Tweets by @NCTUMapVis</a>
            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
          </div>
        </div>
      </div>
      <div id="chart" style="height: 300px;"></div>

    </div><!-- /.container -->

    <nav class="navbar-inverse navbar-fixed-bottom" id="footer">
      <div class="container">
        <a class="lightlink fa fa-github fa-lg" target="_blank" href="https://github.com/RichoHan/map-visualization"> Github Link</a>
        &nbsp;|&nbsp;
        <a class="lightlink fa fa-table fa-lg" target="_blank" href="http://data.gov.tw/node/15453"> 資料來源：98年至103年來台旅客居住地統計</a>
      </div>
    </nav>

    <!-- Bootstrap core JavaScript -->
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

    <!-- D3 core JavaScript -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js"></script>
    <script type="text/javascript" src="static/js/datamaps.world.min.js"></script>

    <!-- Data Processing JavaScript -->
    <script type="text/javascript" src="static/js/jquery.csv.min.js"></script>
    <script src="https://code.highcharts.com/highcharts.js" type="text/javascript"></script>
    <script type="text/javascript" src="static/js/chartkick.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/6.0.13/bootstrap-slider.min.js" type="text/javascript"></script>

    <!-- Customized JavaScript -->
    <script type="text/javascript" src="static/js/index.js"></script>
    <script>
      var map, travelData;
      var yearMin, yearMax;
      var currentCountry = "CHN";
      var currentYear = 2009;

      $("#slider").slider();

      $("#slider").on("slide", function(slideEvt) {
        if(currentYear!=slideEvt.value){
          currentYear = slideEvt.value;
          updateMap(map, travelData, currentYear);
        }
      });

      $.ajax({
        type: "GET",
        url: "static/data/travel_statistics.csv",
        dataType: "text",
        success: function(data) {
          travelData = processData($.csv.toObjects(data));
          map = createMap();
          updateMap(map, travelData, currentYear);
          // drawArcs(map, travelData);
          drawLineChart("China", {
            2009: travelData[currentCountry]["2009"],
            2010: travelData[currentCountry]["2010"],
            2011: travelData[currentCountry]["2011"],
            2012: travelData[currentCountry]["2012"],
            2013: travelData[currentCountry]["2013"],
            2014: travelData[currentCountry]["2014"]
          });
        }
      });
    </script>

  </body>
</html>
